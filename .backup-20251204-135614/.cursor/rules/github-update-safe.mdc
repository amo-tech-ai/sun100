---
alwaysApply: false
---

# Safe GitHub Update - Preserve Local Files

You are an expert Git workflow manager. When updating from GitHub, you must preserve all local files, folders, and important changes while safely integrating remote updates.

## üéØ Core Principle

**NEVER DELETE LOCAL FILES OR FOLDERS** - Always preserve local work, especially:
- `prd.md` - **CRITICAL** Product Requirements Document
- `.cursor/` folder and all rules
- `plan/` folder and all subfolders (pitch-deck/, database/, events/, gemeni/, investors/, crm/, media/, shoot/, fix/)
- `docs/` subfolders (fix/, frontend/, shoot/, events/, sponsor/, services/, media/, prompts/, test-reports/, gemeni/, setup/)
- `screenshoots/` folder - Screenshot references (note: original typo preserved)
- `screenshots/` folder - Screenshot references (if renamed)
- Local test reports and documentation
- Configuration files (`.mcp.json`, etc.)
- Any untracked files that are important

**See also:** `.cursor/rules/never-delete-folders.mdc` for complete folder protection rules.

## üìã Pre-Update Checklist

Before pulling from GitHub, ALWAYS:

### Step 1: Identify Local Files to Preserve

```bash
# Check for important local files and folders
ls -la prd.md 2>/dev/null && echo "‚úÖ prd.md exists" || echo "‚ùå prd.md missing"
ls -la AGENTS.md 2>/dev/null && echo "‚úÖ AGENTS.md exists" || echo "‚ùå AGENTS.md missing"
ls -la supabase/AGENTS.md 2>/dev/null && echo "‚úÖ supabase/AGENTS.md exists" || echo "‚ùå supabase/AGENTS.md missing"
ls -la services/AGENTS.md 2>/dev/null && echo "‚úÖ services/AGENTS.md exists" || echo "‚ùå services/AGENTS.md missing"
ls -la components/AGENTS.md 2>/dev/null && echo "‚úÖ components/AGENTS.md exists" || echo "‚ùå components/AGENTS.md missing"
ls -la screens/AGENTS.md 2>/dev/null && echo "‚úÖ screens/AGENTS.md exists" || echo "‚ùå screens/AGENTS.md missing"
ls -la .cursor/ 2>/dev/null && echo "‚úÖ .cursor exists" || echo "‚ùå .cursor missing"
ls -la plan/ 2>/dev/null && echo "‚úÖ plan exists" || echo "‚ùå plan missing"
ls -la plan/pitch-deck/ 2>/dev/null && echo "‚úÖ plan/pitch-deck exists" || echo "‚ùå plan/pitch-deck missing"
ls -la plan/database/ 2>/dev/null && echo "‚úÖ plan/database exists" || echo "‚ùå plan/database missing"
ls -la plan/events/ 2>/dev/null && echo "‚úÖ plan/events exists" || echo "‚ùå plan/events missing"
ls -la plan/gemeni/ 2>/dev/null && echo "‚úÖ plan/gemeni exists" || echo "‚ùå plan/gemeni missing"
ls -la plan/investors/ 2>/dev/null && echo "‚úÖ plan/investors exists" || echo "‚ùå plan/investors missing"
ls -la plan/crm/ 2>/dev/null && echo "‚úÖ plan/crm exists" || echo "‚ùå plan/crm missing"
ls -la plan/media/ 2>/dev/null && echo "‚úÖ plan/media exists" || echo "‚ö†Ô∏è  plan/media missing (may not exist)"
ls -la docs/fix/ 2>/dev/null && echo "‚úÖ docs/fix exists" || echo "‚ùå docs/fix missing"
ls -la docs/frontend/ 2>/dev/null && echo "‚úÖ docs/frontend exists" || echo "‚ùå docs/frontend missing"
ls -la docs/shoot/ 2>/dev/null && echo "‚úÖ docs/shoot exists" || echo "‚ùå docs/shoot missing"
ls -la docs/events/ 2>/dev/null && echo "‚úÖ docs/events exists" || echo "‚ùå docs/events missing"
ls -la docs/sponsor/ 2>/dev/null && echo "‚úÖ docs/sponsor exists" || echo "‚ùå docs/sponsor missing"
ls -la docs/services/ 2>/dev/null && echo "‚úÖ docs/services exists" || echo "‚ùå docs/services missing"
ls -la docs/media/ 2>/dev/null && echo "‚úÖ docs/media exists" || echo "‚ùå docs/media missing"
ls -la docs/prompts/ 2>/dev/null && echo "‚úÖ docs/prompts exists" || echo "‚ùå docs/prompts missing"
ls -la screenshoots/ 2>/dev/null && echo "‚úÖ screenshoots exists" || echo "‚ùå screenshoots missing"
ls -la screenshots/ 2>/dev/null && echo "‚úÖ screenshots exists" || echo "‚ö†Ô∏è  screenshots missing (may not exist)"
ls -la .mcp.json 2>/dev/null && echo "‚úÖ .mcp.json exists" || echo "‚ùå .mcp.json missing"
```

### Step 2: Create Backup of Critical Files

```bash
# Create timestamped backup
BACKUP_DIR=".backup-$(date +%Y%m%d-%H%M%S)"
mkdir -p "$BACKUP_DIR"
mkdir -p "$BACKUP_DIR/docs"
mkdir -p "$BACKUP_DIR/plan"

# Backup CRITICAL files
[ -f prd.md ] && cp prd.md "$BACKUP_DIR/" 2>/dev/null
[ -f AGENTS.md ] && cp AGENTS.md "$BACKUP_DIR/" 2>/dev/null
[ -f .mcp.json ] && cp .mcp.json "$BACKUP_DIR/" 2>/dev/null
[ -f supabase/AGENTS.md ] && cp supabase/AGENTS.md "$BACKUP_DIR/" 2>/dev/null
[ -f services/AGENTS.md ] && cp services/AGENTS.md "$BACKUP_DIR/" 2>/dev/null
[ -f components/AGENTS.md ] && cp components/AGENTS.md "$BACKUP_DIR/" 2>/dev/null
[ -f screens/AGENTS.md ] && cp screens/AGENTS.md "$BACKUP_DIR/" 2>/dev/null

# Backup critical folders
[ -d .cursor ] && cp -r .cursor "$BACKUP_DIR/" 2>/dev/null
[ -d plan ] && cp -r plan "$BACKUP_DIR/" 2>/dev/null
[ -d plan/pitch-deck ] && cp -r plan/pitch-deck "$BACKUP_DIR/plan/" 2>/dev/null
[ -d plan/database ] && cp -r plan/database "$BACKUP_DIR/plan/" 2>/dev/null
[ -d plan/events ] && cp -r plan/events "$BACKUP_DIR/plan/" 2>/dev/null
[ -d plan/gemeni ] && cp -r plan/gemeni "$BACKUP_DIR/plan/" 2>/dev/null
[ -d plan/investors ] && cp -r plan/investors "$BACKUP_DIR/plan/" 2>/dev/null
[ -d plan/crm ] && cp -r plan/crm "$BACKUP_DIR/plan/" 2>/dev/null
[ -d plan/media ] && cp -r plan/media "$BACKUP_DIR/plan/" 2>/dev/null
[ -d docs/fix ] && cp -r docs/fix "$BACKUP_DIR/docs/" 2>/dev/null
[ -d docs/frontend ] && cp -r docs/frontend "$BACKUP_DIR/docs/" 2>/dev/null
[ -d docs/shoot ] && cp -r docs/shoot "$BACKUP_DIR/docs/" 2>/dev/null
[ -d docs/events ] && cp -r docs/events "$BACKUP_DIR/docs/" 2>/dev/null
[ -d docs/sponsor ] && cp -r docs/sponsor "$BACKUP_DIR/docs/" 2>/dev/null
[ -d docs/services ] && cp -r docs/services "$BACKUP_DIR/docs/" 2>/dev/null
[ -d docs/media ] && cp -r docs/media "$BACKUP_DIR/docs/" 2>/dev/null
[ -d docs/prompts ] && cp -r docs/prompts "$BACKUP_DIR/docs/" 2>/dev/null
[ -d docs/test-reports ] && cp -r docs/test-reports "$BACKUP_DIR/docs/" 2>/dev/null
[ -d docs/gemeni ] && cp -r docs/gemeni "$BACKUP_DIR/docs/" 2>/dev/null
[ -d docs/setup ] && cp -r docs/setup "$BACKUP_DIR/docs/" 2>/dev/null
[ -d screenshoots ] && cp -r screenshoots "$BACKUP_DIR/" 2>/dev/null
[ -d screenshots ] && cp -r screenshots "$BACKUP_DIR/" 2>/dev/null
[ -d supabase ] && cp -r supabase "$BACKUP_DIR/" 2>/dev/null

echo "‚úÖ Backup created: $BACKUP_DIR"
```

### Step 3: Check Git Status

```bash
# Check what will be affected
git status --short
git status --porcelain | grep -E "^\\?\\?" | head -20  # Untracked files
```

### Step 4: Stash Local Changes

```bash
# Stash tracked changes with descriptive message
git stash push -m "Local changes before GitHub update $(date +%Y%m%d-%H%M%S)" --include-untracked

# Verify stash was created
git stash list | head -1
```

## üîÑ Update Process

### Step 5: Fetch and Check Remote Changes

```bash
# Fetch without merging
git fetch origin

# Check what will change
git log HEAD..origin/main --oneline | head -10
git diff --stat HEAD origin/main | head -20
```

### Step 6: Pull with Strategy

```bash
# Pull with rebase to avoid merge commits (or use merge if preferred)
git pull origin main --no-rebase

# If conflicts occur, handle them carefully (see Conflict Resolution below)
```

### Step 7: Restore Critical Local Files

```bash
# PROTECTED FOLDERS LIST
PROTECTED_FOLDERS=(
  "prd.md"                # CRITICAL: Product Requirements Document
  ".cursor"
  "plan"
  "plan/pitch-deck"
  "plan/database"
  "plan/events"
  "plan/gemeni"
  "plan/investors"
  "plan/crm"
  "plan/media"
  "plan/media/events"
  "plan/media/shoot"
  "plan/media/fix"
  "docs/fix"
  "docs/frontend"
  "docs/shoot"
  "docs/events"
  "docs/sponsor"
  "docs/services"
  "docs/media"
  "docs/prompts"
  "docs/test-reports"
  "docs/gemeni"
  "docs/setup"
  "docs/tasks"
  "screenshoots"  # Screenshot references (note: original typo preserved)
  "screenshots"   # Screenshot references (if renamed)
  "supabase"
  ".mcp.json"     # MCP configuration
)

# Restore prd.md if missing
if [ ! -f prd.md ]; then
  if [ -f "$BACKUP_DIR/prd.md" ]; then
    cp "$BACKUP_DIR/prd.md" .
    echo "‚úÖ Restored prd.md from backup"
  elif git stash show stash@{0} --name-only 2>/dev/null | grep -q "^prd.md"; then
    git checkout stash@{0} -- prd.md
    echo "‚úÖ Restored prd.md from stash"
  else
    echo "üî¥ CRITICAL: prd.md missing and not in backup/stash"
  fi
fi

# Restore .cursor folder if missing
if [ ! -d .cursor ]; then
  if [ -d "$BACKUP_DIR/.cursor" ]; then
    cp -r "$BACKUP_DIR/.cursor" .
    echo "‚úÖ Restored .cursor from backup"
  elif git stash show stash@{0} --name-only 2>/dev/null | grep -q "^\.cursor"; then
    git checkout stash@{0} -- .cursor
    echo "‚úÖ Restored .cursor from stash"
  else
    echo "üî¥ CRITICAL: .cursor folder missing and not in backup/stash"
  fi
fi

# Restore plan folder if missing
if [ ! -d plan ]; then
  if [ -d "$BACKUP_DIR/plan" ]; then
    cp -r "$BACKUP_DIR/plan" .
    echo "‚úÖ Restored plan from backup"
  elif git stash show stash@{0} --name-only 2>/dev/null | grep -q "^plan"; then
    git checkout stash@{0} -- plan
    echo "‚úÖ Restored plan from stash"
  else
    echo "üî¥ CRITICAL: plan folder missing and not in backup/stash"
  fi
fi

# Restore plan subfolders if missing
for subfolder in pitch-deck database events gemeni investors crm media; do
  if [ ! -d "plan/$subfolder" ]; then
    echo "‚ö†Ô∏è  WARNING: plan/$subfolder is missing!"
    if [ -d "$BACKUP_DIR/plan/$subfolder" ]; then
      mkdir -p plan 2>/dev/null
      cp -r "$BACKUP_DIR/plan/$subfolder" "plan/"
      echo "‚úÖ Restored plan/$subfolder from backup"
    elif git stash show stash@{0} --name-only 2>/dev/null | grep -q "^plan/$subfolder"; then
      git checkout stash@{0} -- "plan/$subfolder"
      echo "‚úÖ Restored plan/$subfolder from stash"
    else
      echo "üî¥ CRITICAL: plan/$subfolder missing and not in backup/stash - CHECK GIT HISTORY"
    fi
  fi
done

# Restore ALL protected docs subfolders if missing
for folder in fix frontend shoot events sponsor services media prompts test-reports gemeni setup; do
  if [ ! -d "docs/$folder" ]; then
    echo "‚ö†Ô∏è  WARNING: docs/$folder is missing!"
    if [ -d "$BACKUP_DIR/docs/$folder" ]; then
      cp -r "$BACKUP_DIR/docs/$folder" "docs/"
      echo "‚úÖ Restored docs/$folder from backup"
    elif git stash show stash@{0} --name-only 2>/dev/null | grep -q "^docs/$folder"; then
      git checkout stash@{0} -- "docs/$folder"
      echo "‚úÖ Restored docs/$folder from stash"
    else
      echo "üî¥ CRITICAL: docs/$folder missing and not in backup/stash - CHECK GIT HISTORY"
    fi
  fi
done

# Restore screenshoots folder if missing
if [ ! -d screenshoots ]; then
  if [ -d "$BACKUP_DIR/screenshoots" ]; then
    cp -r "$BACKUP_DIR/screenshoots" .
    echo "‚úÖ Restored screenshoots from backup"
  elif git stash show stash@{0} --name-only 2>/dev/null | grep -q "^screenshoots"; then
    git checkout stash@{0} -- screenshoots
    echo "‚úÖ Restored screenshoots from stash"
  else
    echo "‚ö†Ô∏è  WARNING: screenshoots folder missing - CHECK GIT HISTORY"
  fi
fi

# Restore screenshots folder if missing (if renamed)
if [ ! -d screenshots ] && [ -d "$BACKUP_DIR/screenshots" ]; then
  cp -r "$BACKUP_DIR/screenshots" .
  echo "‚úÖ Restored screenshots from backup"
fi

# Restore .mcp.json if missing
if [ ! -f .mcp.json ] && [ -f "$BACKUP_DIR/.mcp.json" ]; then
  cp "$BACKUP_DIR/.mcp.json" .
  echo "‚úÖ Restored .mcp.json from backup"
fi

# Restore AGENTS.md files if missing
if [ ! -f AGENTS.md ] && [ -f "$BACKUP_DIR/AGENTS.md" ]; then
  cp "$BACKUP_DIR/AGENTS.md" .
  echo "‚úÖ Restored AGENTS.md from backup"
fi

if [ ! -f supabase/AGENTS.md ] && [ -f "$BACKUP_DIR/supabase/AGENTS.md" ]; then
  cp "$BACKUP_DIR/supabase/AGENTS.md" supabase/
  echo "‚úÖ Restored supabase/AGENTS.md from backup"
fi

if [ ! -f services/AGENTS.md ] && [ -f "$BACKUP_DIR/services/AGENTS.md" ]; then
  cp "$BACKUP_DIR/services/AGENTS.md" services/
  echo "‚úÖ Restored services/AGENTS.md from backup"
fi

if [ ! -f components/AGENTS.md ] && [ -f "$BACKUP_DIR/components/AGENTS.md" ]; then
  cp "$BACKUP_DIR/components/AGENTS.md" components/
  echo "‚úÖ Restored components/AGENTS.md from backup"
fi

if [ ! -f screens/AGENTS.md ] && [ -f "$BACKUP_DIR/screens/AGENTS.md" ]; then
  cp "$BACKUP_DIR/screens/AGENTS.md" screens/
  echo "‚úÖ Restored screens/AGENTS.md from backup"
fi

# Verify all protected folders exist
echo "üîç Verifying protected folders..."
for folder in "${PROTECTED_FOLDERS[@]}"; do
  if [ ! -e "$folder" ]; then
    echo "üî¥ MISSING: $folder"
  else
    echo "‚úÖ EXISTS: $folder"
  fi
done
```

### Step 8: Restore Stashed Changes (Selective)

```bash
# List stashed changes
git stash show stash@{0} --name-only | head -20

# Apply stash (this may create conflicts - handle carefully)
git stash pop stash@{0}

# If conflicts occur, resolve them (see Conflict Resolution)
```

## üîß Conflict Resolution

### When Conflicts Occur:

1. **Identify conflicting files:**
   ```bash
   git status | grep "both modified"
   ```

2. **For each conflict:**
   - **If local file is important:** Keep local version
   - **If remote file is important:** Accept remote version
   - **If both are important:** Manually merge

3. **Example: Resolve conflict in `src/index.css`:**
   ```bash
   # Open file and look for conflict markers:
   # <<<<<<< HEAD (local)
   # ... local changes ...
   # =======
   # ... remote changes ...
   # >>>>>>> origin/main (remote)
   
   # Manually edit to combine both changes
   # Then mark as resolved:
   git add src/index.css
   ```

4. **For `.cursor/` folder conflicts:**
   - **ALWAYS keep local version** - Cursor rules are local configuration
   - If remote has new rules, manually copy them

5. **For `docs/` subfolder conflicts:**
   - **ALWAYS keep local version** - Local documentation is important
   - Review remote changes and manually integrate if needed

## ‚úÖ Post-Update Verification

### Step 9: Verify Critical Files Exist

```bash
# Verify all critical files and folders exist
[ -f prd.md ] && echo "‚úÖ prd.md exists" || echo "‚ùå prd.md MISSING - RESTORE IMMEDIATELY"
[ -d .cursor ] && echo "‚úÖ .cursor exists" || echo "‚ùå .cursor MISSING - RESTORE IMMEDIATELY"
[ -d .cursor/rules ] && echo "‚úÖ .cursor/rules exists" || echo "‚ùå .cursor/rules MISSING"
[ -d plan ] && echo "‚úÖ plan exists" || echo "‚ùå plan MISSING - RESTORE IMMEDIATELY"
[ -d plan/pitch-deck ] && echo "‚úÖ plan/pitch-deck exists" || echo "‚ùå plan/pitch-deck MISSING - RESTORE IMMEDIATELY"
[ -d plan/database ] && echo "‚úÖ plan/database exists" || echo "‚ùå plan/database MISSING - RESTORE IMMEDIATELY"
[ -d plan/events ] && echo "‚úÖ plan/events exists" || echo "‚ùå plan/events MISSING - RESTORE IMMEDIATELY"
[ -d plan/gemeni ] && echo "‚úÖ plan/gemeni exists" || echo "‚ùå plan/gemeni MISSING - RESTORE IMMEDIATELY"
[ -d plan/investors ] && echo "‚úÖ plan/investors exists" || echo "‚ùå plan/investors MISSING - RESTORE IMMEDIATELY"
[ -d plan/crm ] && echo "‚úÖ plan/crm exists" || echo "‚ùå plan/crm MISSING - RESTORE IMMEDIATELY"
[ -d plan/media ] && echo "‚úÖ plan/media exists" || echo "‚ö†Ô∏è  plan/media missing (may not exist)"
[ -d docs/fix ] && echo "‚úÖ docs/fix exists" || echo "‚ö†Ô∏è  docs/fix missing (may be new)"
[ -d docs/frontend ] && echo "‚úÖ docs/frontend exists" || echo "‚ö†Ô∏è  docs/frontend missing (may be new)"
[ -d screenshoots ] && echo "‚úÖ screenshoots exists" || echo "‚ùå screenshoots MISSING - RESTORE IMMEDIATELY"
[ -d screenshots ] && echo "‚úÖ screenshots exists" || echo "‚ö†Ô∏è  screenshots missing (may not exist)"
[ -d supabase ] && echo "‚úÖ supabase exists" || echo "‚ùå supabase MISSING - RESTORE IMMEDIATELY"
[ -f .mcp.json ] && echo "‚úÖ .mcp.json exists" || echo "‚ö†Ô∏è  .mcp.json missing"
```

### Step 10: Check for Deleted Files

```bash
# Check if any important files were deleted
git status | grep "deleted:" | head -10

# If critical folders were deleted, restore immediately:
if [ ! -d .cursor ]; then
  echo "üî¥ CRITICAL: .cursor folder deleted - restoring from backup"
  [ -d "$BACKUP_DIR/.cursor" ] && cp -r "$BACKUP_DIR/.cursor" .
fi
if [ ! -d plan ]; then
  echo "üî¥ CRITICAL: plan folder deleted - restoring from backup"
  [ -d "$BACKUP_DIR/plan" ] && cp -r "$BACKUP_DIR/plan" .
fi
if [ ! -d screenshoots ]; then
  echo "üî¥ CRITICAL: screenshoots folder deleted - restoring from backup"
  [ -d "$BACKUP_DIR/screenshoots" ] && cp -r "$BACKUP_DIR/screenshoots" .
fi
if [ ! -d supabase ]; then
  echo "üî¥ CRITICAL: supabase folder deleted - restoring from backup"
  [ -d "$BACKUP_DIR/supabase" ] && cp -r "$BACKUP_DIR/supabase" .
fi
```

### Step 11: Update Progress Tracker

```bash
# Update progress tracker with update info
TRACKER_FILE="plan/media/progress-tracker-matrix.md"
[ -f "$TRACKER_FILE" ] || TRACKER_FILE="docs/progress-tracker-matrix.md"
[ -f "$TRACKER_FILE" ] && {
  echo "## GitHub Update - $(date +%Y-%m-%d %H:%M:%S)" >> "$TRACKER_FILE"
  echo "- Updated from: $(git log origin/main --oneline -1)" >> "$TRACKER_FILE"
  echo "- Local files preserved: ‚úÖ" >> "$TRACKER_FILE"
}
```

## üö® Critical Rules - FOLDER PROTECTION

### ‚ùå NEVER DO:
- ‚ùå `git reset --hard` (destroys local changes)
- ‚ùå `git clean -fd` (deletes untracked files)
- ‚ùå Delete `.cursor/` folder
- ‚ùå Delete `docs/` subfolders
- ‚ùå Delete ANY folder without explicit user permission
- ‚ùå Force push without backup
- ‚ùå Skip backup step
- ‚ùå Use `rm -rf` on any project folder
- ‚ùå Accept deletions of folders in git operations

### üõ°Ô∏è FOLDER PROTECTION RULES

**CRITICAL FILES & FOLDERS - NEVER DELETE:**
1. `prd.md` - **CRITICAL** Product Requirements Document (complete product spec)
2. `AGENTS.md` - **CRITICAL** Root agent instructions (coding guidelines)
3. `.cursor/` - Cursor configuration and rules (including cursor-browser.mdc)
4. `.mcp.json` - MCP configuration
5. `supabase/AGENTS.md` - Edge Functions & database patterns
6. `services/AGENTS.md` - Service layer patterns
7. `components/AGENTS.md` - React component guidelines
8. `screens/AGENTS.md` - Page-level component patterns
4. `plan/` - Planning and documentation root
5. `plan/pitch-deck/` - Pitch deck generation planning and documentation
6. `plan/database/` - Database schema and migration planning
7. `plan/events/` - Event wizard planning
8. `plan/gemeni/` - Gemini AI integration planning
9. `plan/investors/` - Investor docs module planning
10. `plan/crm/` - CRM system planning and documentation
11. `plan/media/` - Media integration planning (Cloudinary, Instagram, Amazon, Shopify)
12. `plan/media/events/` - Event media planning
13. `plan/media/shoot/` - Shoot booking media planning
14. `plan/media/fix/` - Fix and restoration planning
15. `docs/fix/` - Fix documentation
16. `docs/frontend/` - Frontend documentation
17. `docs/shoot/` - Shoot booking documentation
18. `docs/events/` - Event planning documentation
19. `docs/sponsor/` - Sponsor system documentation
20. `docs/services/` - Service documentation
21. `docs/media/` - Media integration documentation
22. `docs/prompts/` - AI prompts and templates
23. `docs/test-reports/` - Test reports
24. `docs/gemeni/` - Gemini AI documentation
25. `docs/setup/` - Setup guides
26. `docs/tasks/` - Task documentation
27. `screenshoots/` - Screenshot references (note: original typo preserved)
28. `screenshots/` - Screenshot references (if renamed)
29. `supabase/` - Supabase migrations and docs

**BEFORE ANY DELETE OPERATION:**
1. Check if folder is in protected list
2. If protected, STOP and ask user
3. Create backup before deletion
4. Verify backup succeeded
5. Only then proceed with deletion (if user confirms)

### ‚úÖ ALWAYS DO:
- ‚úÖ Create backup before update
- ‚úÖ Check git status first
- ‚úÖ Stash with `--include-untracked`
- ‚úÖ Verify critical files after update
- ‚úÖ Restore missing files immediately
- ‚úÖ Document what was changed
- ‚úÖ Test application after update

## üìù Standard Workflow

```bash
# 1. Backup
BACKUP_DIR=".backup-$(date +%Y%m%d-%H%M%S)"
mkdir -p "$BACKUP_DIR"
mkdir -p "$BACKUP_DIR/docs"
mkdir -p "$BACKUP_DIR/plan"
[ -f prd.md ] && cp prd.md "$BACKUP_DIR/"
[ -f .mcp.json ] && cp .mcp.json "$BACKUP_DIR/"
[ -d .cursor ] && cp -r .cursor "$BACKUP_DIR/"
[ -d plan ] && cp -r plan "$BACKUP_DIR/"
[ -d docs ] && find docs -type d -mindepth 1 -maxdepth 1 -exec cp -r {} "$BACKUP_DIR/docs/" \;
[ -d screenshoots ] && cp -r screenshoots "$BACKUP_DIR/" 2>/dev/null
[ -d screenshots ] && cp -r screenshots "$BACKUP_DIR/" 2>/dev/null
[ -d supabase ] && cp -r supabase "$BACKUP_DIR/"

# 2. Stash
git stash push -m "Local changes before GitHub update $(date +%Y%m%d-%H%M%S)" --include-untracked

# 3. Pull
git pull origin main

# 4. Restore critical files
[ ! -f prd.md ] && [ -f "$BACKUP_DIR/prd.md" ] && cp "$BACKUP_DIR/prd.md" .
[ ! -f .mcp.json ] && [ -f "$BACKUP_DIR/.mcp.json" ] && cp "$BACKUP_DIR/.mcp.json" .
[ ! -d .cursor ] && [ -d "$BACKUP_DIR/.cursor" ] && cp -r "$BACKUP_DIR/.cursor" .
[ ! -d plan ] && [ -d "$BACKUP_DIR/plan" ] && cp -r "$BACKUP_DIR/plan" .
# Restore plan subfolders
for subfolder in pitch-deck database events gemeni investors crm media; do
  [ ! -d "plan/$subfolder" ] && [ -d "$BACKUP_DIR/plan/$subfolder" ] && mkdir -p plan && cp -r "$BACKUP_DIR/plan/$subfolder" "plan/"
done
[ ! -d screenshoots ] && [ -d "$BACKUP_DIR/screenshoots" ] && cp -r "$BACKUP_DIR/screenshoots" .
[ ! -d screenshots ] && [ -d "$BACKUP_DIR/screenshots" ] && cp -r "$BACKUP_DIR/screenshots" .
[ ! -d supabase ] && [ -d "$BACKUP_DIR/supabase" ] && cp -r "$BACKUP_DIR/supabase" .

# 5. Pop stash (handle conflicts)
git stash pop

# 6. Verify
[ -f prd.md ] && echo "‚úÖ prd.md exists" || echo "‚ùå RESTORE prd.md"
[ -d .cursor ] && echo "‚úÖ .cursor exists" || echo "‚ùå RESTORE .cursor"
[ -d plan ] && echo "‚úÖ plan exists" || echo "‚ùå RESTORE plan"
[ -d plan/pitch-deck ] && echo "‚úÖ plan/pitch-deck exists" || echo "‚ùå RESTORE plan/pitch-deck"
[ -d plan/database ] && echo "‚úÖ plan/database exists" || echo "‚ùå RESTORE plan/database"
[ -d plan/events ] && echo "‚úÖ plan/events exists" || echo "‚ùå RESTORE plan/events"
[ -d plan/gemeni ] && echo "‚úÖ plan/gemeni exists" || echo "‚ùå RESTORE plan/gemeni"
[ -d plan/investors ] && echo "‚úÖ plan/investors exists" || echo "‚ùå RESTORE plan/investors"
[ -d plan/crm ] && echo "‚úÖ plan/crm exists" || echo "‚ùå RESTORE plan/crm"
[ -d screenshoots ] && echo "‚úÖ screenshoots exists" || echo "‚ùå RESTORE screenshoots"
[ -d screenshots ] && echo "‚úÖ screenshots exists" || echo "‚ö†Ô∏è  screenshots missing (may not exist)"
[ -d supabase ] && echo "‚úÖ supabase exists" || echo "‚ùå RESTORE supabase"
[ -f .mcp.json ] && echo "‚úÖ .mcp.json exists" || echo "‚ö†Ô∏è  .mcp.json missing"
```

## üîç Troubleshooting

### Issue: `prd.md` file deleted after update

**Solution:**
```bash
# Option 1: Restore from backup
cp "$BACKUP_DIR/prd.md" .

# Option 2: Restore from stash
git checkout stash@{0} -- prd.md

# Option 3: Restore from git history
git log --all --full-history --oneline -- prd.md | head -1
git checkout <commit-hash> -- prd.md
```

### Issue: `.cursor` folder deleted after update

**Solution:**
```bash
# Option 1: Restore from backup
cp -r "$BACKUP_DIR/.cursor" .

# Option 2: Restore from stash
git checkout stash@{0} -- .cursor

# Option 3: Restore from git history
git log --all --full-history --oneline -- .cursor | head -1
git checkout <commit-hash> -- .cursor
```

### Issue: `plan/` folder or subfolders deleted

**Solution:**
```bash
# Restore entire plan folder from backup
if [ ! -d plan ] && [ -d "$BACKUP_DIR/plan" ]; then
  cp -r "$BACKUP_DIR/plan" .
  echo "‚úÖ Restored plan/ from backup"
fi

# OR restore individual subfolders
for subfolder in pitch-deck database events gemeni investors crm media; do
  if [ ! -d "plan/$subfolder" ] && [ -d "$BACKUP_DIR/plan/$subfolder" ]; then
    mkdir -p plan
    cp -r "$BACKUP_DIR/plan/$subfolder" "plan/"
    echo "‚úÖ Restored plan/$subfolder from backup"
  fi
done

# OR restore from git history
git log --all --full-history --oneline -- plan/ | head -5
git checkout <commit-hash> -- plan/
```

### Issue: `docs/` subfolders deleted

**Solution:**
```bash
# Restore from backup
for folder in fix frontend shoot events sponsor services media prompts test-reports gemeni setup tasks; do
  [ ! -d "docs/$folder" ] && [ -d "$BACKUP_DIR/docs/$folder" ] && \
    cp -r "$BACKUP_DIR/docs/$folder" "docs/"
done
```

### Issue: `screenshoots/` folder deleted

**Solution:**
```bash
# Restore from backup
if [ ! -d screenshoots ] && [ -d "$BACKUP_DIR/screenshoots" ]; then
  cp -r "$BACKUP_DIR/screenshoots" .
  echo "‚úÖ Restored screenshoots/ from backup"
fi

# Or restore from git history
git log --all --full-history --oneline -- screenshoots/ | head -1
git checkout <commit-hash> -- screenshoots/
```

### Issue: Merge conflicts in important files

**Solution:**
- For `.cursor/` files: **Always keep local**
- For `docs/` files: **Keep local, review remote manually**
- For `src/` files: **Merge carefully, test after**

## üìä Update Log Template

After each update, document:

```markdown
## GitHub Update - YYYY-MM-DD HH:MM:SS

**Remote Changes:**
- Commit: `git log origin/main --oneline -1`
- Files changed: `git diff --stat HEAD@{1} HEAD`

**Local Files Preserved:**
- ‚úÖ prd.md (Product Requirements Document)
- ‚úÖ .cursor/ folder
- ‚úÖ plan/ folder and all subfolders:
  - ‚úÖ plan/pitch-deck/
  - ‚úÖ plan/database/
  - ‚úÖ plan/events/
  - ‚úÖ plan/gemeni/
  - ‚úÖ plan/investors/
  - ‚úÖ plan/crm/
  - ‚úÖ plan/media/ (if exists)
- ‚úÖ docs/fix/ folder
- ‚úÖ docs/frontend/ folder
- ‚úÖ screenshoots/ folder (screenshot references)
- ‚úÖ screenshots/ folder (if renamed)
- ‚úÖ supabase/ folder
- ‚úÖ .mcp.json
- ‚úÖ ... (list all preserved)

**Conflicts Resolved:**
- File: `path/to/file` - Resolution: (kept local/merged/kept remote)

**Issues Found:**
- (List any issues)

**Status:** ‚úÖ Complete / ‚ö†Ô∏è Needs Attention
```

## üéØ Quick Reference

**Before Update:**
1. Backup critical folders
2. Stash local changes
3. Check remote changes

**During Update:**
1. Pull from GitHub
2. Restore critical files if missing
3. Resolve conflicts (prefer local for config/docs)

**After Update:**
1. Verify critical files exist
2. Test application
3. Update progress tracker
4. Document changes

---

**Remember:** Local files are valuable. When in doubt, preserve local over remote for configuration and documentation files.
